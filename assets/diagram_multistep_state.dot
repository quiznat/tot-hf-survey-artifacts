digraph G {
  graph [bgcolor="#ffffff", pad="0.06", nodesep="0.34", ranksep="0.50", splines="polyline", fontname="Helvetica", fontcolor="#162130", margin="0.02", rankdir="TB", ranksep="0.56", nodesep="0.34"];
  node [shape="box", style="filled", fillcolor="#ffffff", color="#445a79", penwidth="1.5", fontname="Helvetica", fontsize="9", margin="0.08,0.06"];
  edge [color="#445a79", penwidth="1.3", arrowsize="0.70", fontname="Helvetica", fontsize="11", fontcolor="#162130"];

  input [label="Input Task"];
  init [label="Initialize State"];
  plan [label="Generate / Update Plan"];
  step [label="Execute Next Step"];
  observe [label="Collect Observation"];
  goal [shape="diamond", style="filled", fillcolor="#ffffff", color="#445a79", penwidth="1.5", fontname="Helvetica", fontsize="9", margin="0.04,0.04", label="Goal\nSatisfied?"];
  replan [shape="diamond", style="filled", fillcolor="#ffffff", color="#445a79", penwidth="1.5", fontname="Helvetica", fontsize="9", margin="0.04,0.04", label="Need\nReplan?"];
  out [label="Return Final Response"];

  input -> init -> plan -> step -> observe -> goal;
  goal -> out [label="Yes"];
  goal -> replan [label="No"];
  replan -> plan [label="Yes", constraint=false];
  replan -> step [label="No", constraint=false];

  { rank=same; goal; replan }
}
